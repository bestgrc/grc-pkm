zookeeper 实现分布式锁  可以去了解一下。看redis的时候经常有文章提到。

